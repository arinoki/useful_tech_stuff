# README.md

[English version](README_en.md)

## Скрипт Folder to Playlists

Этот Python-скрипт сканирует директорию с музыкой и генерирует плейлисты в формате M3U8 на основе группировки по артистам или альбомам, используя метаданные из аудиофайлов.

### Возможности
- Поддержка различных аудиоформатов: MP3, M4A, FLAC, OGG, OPUS, WMA, APE, AIFF, WAV и других.
- Группировка по артистам (по умолчанию) или альбомам.
- Автоматическое определение сборников (компилаций) на основе уникальных артистов в папке или флага compilation в метаданных.
- Исключение указанных директорий из обработки.
- Минимальное количество треков для создания плейлиста (по умолчанию 2).
- Разделение больших плейлистов на части по 500 треков.
- Очистка ключей группировки для безопасных имен файлов.
- Отладочный режим для verbose-логов.

### Требования
- Python 3.6+ (протестировано на 3.12.3).
- Библиотека Mutagen: `pip install mutagen`.

### Установка
1. Установите Python, если он не установлен.
2. Установите Mutagen: `pip install mutagen`.
3. Скачайте скрипт `folder_to_playlists.py`.

### Использование
Запустите скрипт из командной строки:

```
python folder_to_playlists.py [root_dir] [playlists_dir] [mode]
```

- `root_dir`: Корневая директория с музыкой (по умолчанию: 'C:/!!Downloads/Music').
- `playlists_dir`: Директория для сохранения плейлистов (по умолчанию: 'C:/Users/arinoki/Desktop/playlists').
- `mode`: Режим группировки — 'artist' (по артистам) или 'album' (по альбомам, по умолчанию 'artist').

Если аргументы не указаны, скрипт запросит их интерактивно.

### Конфигурация
Редактируйте константы в скрипте:
- `DEFAULT_ROOT_DIR`: Корневая директория по умолчанию.
- `DEFAULT_PLAYLISTS_DIR`: Директория плейлистов по умолчанию.
- `DEFAULT_MODE`: Режим по умолчанию ('artist' или 'album').
- `DEBUG`: Включить отладочные логи (True/False).
- `MIN_TRACKS_PER_PLAYLIST`: Минимальное количество треков для плейлиста.
- `AUDIO_EXTS`: Список поддерживаемых расширений.
- `EXCLUDED_DIRS_RAW`: Список исключаемых директорий.
- `UNIQUE_ARTIST_THRESHOLD`: Порог уникальных артистов для определения сборника.

### Примеры
- Группировка по артистам: `python folder_to_playlists.py "C:/Music" "C:/Playlists" artist`
- Группировка по альбомам: `python folder_to_playlists.py "C:/Music" "C:/Playlists" album`

### Логика работы
- В режиме 'artist': Группирует треки по albumartist или artist из метаданных. Для сборников использует "Various Artists - [album или имя папки]".
- В режиме 'album': Создает плейлист для каждой папки с аудиофайлами, используя имя папки как ключ.
- Пропускает исключенные директории.
- Сортирует треки по имени файла.
- Выводит сводку: обработанные директории, пропущенные, созданные плейлисты.

### Ограничения
- Нет поддержки установки дополнительных пакетов (использует только Mutagen).
- Обрабатывает только локальные файлы.
- Для больших коллекций может потребоваться время.

### Лицензия
CC BY‑NC‑SA 4.0